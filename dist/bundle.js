(()=>{"use strict";class t{constructor(t,e,s,i="regular"){this.canvas=t,this.size=40,this.baseSpeed=e,this.speedMultiplier=1,this.rejectDecayRate=.05,this.color=s.color,this.number=s.number,this.type=i,this.shape=["circle","rectangle"][Math.floor(2*Math.random())],this.scale=1,this.isGlowing=!1,this.skullImage=new Image,this.isImageLoaded=!1,this.skullImage.onload=()=>{this.isImageLoaded=!0},this.skullImage.src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Skull_and_crossbones.svg/1024px-Skull_and_crossbones.svg.png",this.spawn()}spawn(){this.x=50+Math.random()*(this.canvas.width-this.size-100),this.y=50+Math.random()*(this.canvas.height-this.size-100),this.dx=(Math.random()-.5)*this.baseSpeed,this.dy=(Math.random()-.5)*this.baseSpeed}reject(){this.speedMultiplier=Math.min(this.speedMultiplier+1.2,3),this.scale=1.3}update(t){this.speedMultiplier=Math.max(1,this.speedMultiplier-this.rejectDecayRate),this.scale=Math.max(1,this.scale-.05),"regular"===this.type&&(this.isGlowing=1===Math.abs(this.number-t.number)),this.x+=this.dx*this.speedMultiplier,this.y+=this.dy*this.speedMultiplier,(this.x<=0||this.x+this.size>=this.canvas.width)&&(this.dx*=-1,this.x=Math.max(0,Math.min(this.x,this.canvas.width-this.size))),(this.y<=0||this.y+this.size>=this.canvas.height)&&(this.dy*=-1,this.y=Math.max(0,Math.min(this.y,this.canvas.height-this.size)))}draw(t){t.save(),t.translate(this.x+this.size/2,this.y+this.size/2),t.scale(this.scale,this.scale),t.translate(-(this.x+this.size/2),-(this.y+this.size/2)),"hazard"===this.type?(t.fillStyle="#000000",t.fillRect(this.x,this.y,this.size,this.size),this.isImageLoaded&&t.drawImage(this.skullImage,this.x,this.y,this.size,this.size)):(this.isGlowing?(t.shadowColor="rgba(255, 255, 0, 0.8)",t.shadowBlur=10):t.shadowBlur=0,t.fillStyle=this.color,"circle"===this.shape?(t.beginPath(),t.arc(this.x+this.size/2,this.y+this.size/2,this.size/2,0,2*Math.PI),t.fill()):"rectangle"===this.shape&&t.fillRect(this.x,this.y,this.size,this.size),"regular"===this.type&&(t.fillStyle="#FFFFFF",t.font="bold 20px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText(this.number,this.x+this.size/2,this.y+this.size/2))),t.restore()}}const e=[{color:"#FF0000",number:1},{color:"#00FF00",number:2},{color:"#0000FF",number:3},{color:"#FFFF00",number:4},{color:"#FF00FF",number:5},{color:"#00FFFF",number:6},{color:"#800000",number:7},{color:"#808000",number:8},{color:"#008000",number:9},{color:"#800080",number:10},{color:"#008080",number:11},{color:"#000080",number:12},{color:"#FFA500",number:13},{color:"#A52A2A",number:14},{color:"#8A2BE2",number:15},{color:"#5F9EA0",number:16}],s=["#FFD700","#00FF00","#00FFFF","#FF69B4","#9370DB","#1E90FF"];class i{constructor(){this.canvas=document.getElementById("gameCanvas"),this.ctx=this.canvas.getContext("2d"),this.currentBgIndex=0,this.nextBgIndex=1,this.bgTransitionProgress=0,this.scoreInitialized=!1,this.gameOver=!1,this.setupStartButton(),window.addEventListener("resize",(()=>this.resize()))}setupStartButton(){const t=document.createElement("button");t.id="startButton",t.textContent="Start",t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.fontSize="24px",document.body.appendChild(t),t.addEventListener("click",(()=>{document.body.removeChild(t),this.setup(),this.gameLoop()}))}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}setup(){this.scoreInitialized||(this.score=0,this.scoreInitialized=!0),this.player={x:100,y:100,size:50,color:e[0].color,number:e[0].number},window.player=this.player,this.targets=[],this.spawnTargets(),this.resize(),this.setupInteractionEvents(),document.getElementById("score").textContent=`Score: ${this.score}`,document.getElementById("level").textContent="Level: 1",this.gameActive=!0,this.gameOver=!1,this.updateBackgroundColors(),this.startBackgroundUpdate(),this.draw(),this.canvas.style.backgroundColor=s[this.currentBgIndex]}spawnTargets(){this.targets=[],window.targets=this.targets;for(let s=0;s<10;s++){const i=(2+s-1)%e.length+1,a=e.find((t=>t.number===i));this.targets.push(new t(this.canvas,2+3*Math.random(),a))}for(let e=0;e<2;e++)this.targets.push(new t(this.canvas,3+2*Math.random(),{color:"#000000",number:null},"hazard"))}setupInteractionEvents(){this.canvas.addEventListener("mousemove",(t=>{this.gameActive&&this.handleInteraction(t)})),this.canvas.addEventListener("touchmove",(t=>{t.preventDefault(),this.gameActive&&this.handleInteraction(t.touches[0])}),{passive:!1})}handleInteraction(t){const e=this.canvas.getBoundingClientRect(),s=(t.clientX||t.pageX)-e.left,i=(t.clientY||t.pageY)-e.top;this.player.x=s-this.player.size/2,this.player.y=i-this.player.size/2,this.checkCollisions()}checkCollisions(){this.targets=this.targets.filter((t=>{if(this.player.x<t.x+t.size&&this.player.x+this.player.size>t.x&&this.player.y<t.y+t.size&&this.player.y+this.player.size>t.y){if("hazard"===t.type)return this.endGame(),!1;if(t.number===this.player.number+1||t.number===this.player.number-1)return this.score++,this.player.color=function(t,e){const s=document.createElement("canvas").getContext("2d");s.fillStyle=t,s.fillRect(0,0,1,1);const i=s.getImageData(0,0,1,1).data;s.fillStyle=e,s.fillRect(0,0,1,1);const a=s.getImageData(0,0,1,1).data;return`rgb(${Math.round((i[0]+a[0])/2)}, ${Math.round((i[1]+a[1])/2)}, ${Math.round((i[2]+a[2])/2)})`}(this.player.color,t.color),this.player.number=t.number,document.getElementById("score").textContent=`Score: ${this.score}`,!1;t.reject()}return!0})),0!==this.targets.length||this.gameOver||(this.stopBackgroundUpdate(),this.setup())}endGame(){this.gameActive=!1,this.gameOver=!0,alert("Game Over!")}updateBackgroundColors(){const t=document.documentElement,e=s[this.currentBgIndex],i=s[this.nextBgIndex];t.style.setProperty("--bg-color-start",e),t.style.setProperty("--bg-color-end",i),this.currentBgIndex=this.nextBgIndex,this.nextBgIndex=(this.nextBgIndex+1)%s.length}startBackgroundUpdate(){const t=()=>{this.updateBackgroundColors();const e=5e3*Math.random()+5e3;this.bgTimeout=setTimeout(t,e)};t()}stopBackgroundUpdate(){clearTimeout(this.bgTimeout)}update(){this.gameOver||this.targets.forEach((t=>t.update(this.player)))}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.targets.forEach((t=>t.draw(this.ctx))),this.ctx.fillStyle=this.player.color,this.ctx.fillRect(this.player.x,this.player.y,this.player.size,this.player.size),this.ctx.fillStyle="#FFFFFF",this.ctx.font="bold 20px Arial",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(this.player.number,this.player.x+this.player.size/2,this.player.y+this.player.size/2)}gameLoop(){this.gameActive&&(this.update(),this.draw(),requestAnimationFrame((()=>this.gameLoop())))}}window.onload=()=>{new i}})();